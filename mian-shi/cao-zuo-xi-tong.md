# 操作系统

## 1.进程与线程的区别

1、进程是资源分配的最小单位，线程是程序执行的最小单位（资源调度的最小单位） 

2、进程有自己的独立地址空间，每启动一个进程，系统就会为它分配地址空间，建立数据表来维护代码段、堆栈段和数据段，这种操作非常昂贵。 而线程是共享进程中的数据的，使用相同的地址空间，因此CPU切换一个线程的花费远比进程要小很多，同时创建一个线程的开销也比进程要小很多。 

3、线程之间的通信更方便，同一进程下的线程共享全局变量、静态变量等数据，而进程之间的通信需要以通信的方式（IPC\)进行。不过如何处理好同步与互斥是编写多线程程序的难点。

 4、但是多进程程序更健壮，多线程程序只要有一个线程死掉，整个进程也死掉了，而一个进程死掉并不会对另外一个进程造成影响，因为进程有自己独立的地址空间。

## 2.什么是内存泄漏？

自己打的：内存泄漏是指，程序运行过程中由于没有及时释放系统所分配的内存而导致程序执行异常或者系统崩溃的一种异常现象

注意是堆内存

百度解释：“内存泄漏（Memory Leak）是指程序中己动态分配的**堆内存**由于某种原因程序未释放或无法释放，造成系统内存的浪费，导致程序运行速度减慢甚至系统崩溃等严重后果。”

## 3.内存泄漏的表现形式？

分为4种，其实很好记，发生的频率从高到低

常发性，一段会导致内存泄漏的被重复执行

偶发性，与常发性内存泄漏相对

一次性，只执行一次，比方说某些对象被创建时导致的泄漏

隐性，程序在长时间执行时，由于不停申请内存，并且程序不停止就不会释放，在长时间工作或者压力测试下就会导致内存泄漏

## 4.有哪些操作可能导致内存泄漏？

调用了数据库的游标而忘记返回。

文件描述符调用后未释放，其实这个我自己经历过，一个线程池频繁创建socket fd没有关闭，在运行了1个礼拜后，异常退出，导致了内存泄漏

## 5.栈和队列在内存管理方面的区别

？

## 6.堆栈队列

先说堆，什么大根堆小根堆记得吧，所以堆是树状的一种数据结构，堆是在程序运行时动态申请，动态分配的

栈就不一样了，由于他先进先出的特性，很容易让人联想到断点以及还原，所以程序在一开始运行需要的内存就由系统分配在栈里了

队列，没啥好说，先进后出

队列与栈都可以用数组与链表实现

## 7.进程，线程，协程

进程是系统分配资源的最小单位，一个运行起来的程序就可以看做一个进程 ，每个进程都拥有自己独立的内存空间，所以切换起来没有线程快，但是相对安全

线程是CPU进行资源调度的最小单位，一个进程内可以拥有很多线程，一个线程内不同的线程共享相同的内存，因此线程的切换比进程的切换要快，但是其中一个线程如果挂了，其他的线程也挂了，因此没有进程安全

协程是一种轻量级线程，由用户进行调度，比较典型的协程就是Python里面的生成器。生成器里面的yield语句就是用户调用一次，执行一次，不同的调用之间可以去执行不同的语句

## 8.讲一讲虚拟内存？

虚拟内存的目的是为了让物理内存扩充成更大的逻辑内存，从而让程序获得更多的可用内存。

为了更好的管理内存，操作系统将内存抽象成地址空间。每个程序拥有自己的地址空间，这个地址空间被分割成多个块，每一块称为一页。这些页被映射到物理内存，但不需要映射到连续的物理内存，也不需要所有页都必须在物理内存中。当程序引用到不在物理内存中的页时，由硬件执行必要的映射，将缺失的部分装入物理内存并重新执行失败的指令。

从上面的描述中可以看出，虚拟内存允许程序不用将地址空间中的每一页都映射到物理内存，也就是说一个程序不需要全部调入内存就可以运行，这使得有限的内存运行大程序成为可能。例如有一台计算机可以产生 16 位地址，那么一个程序的地址空间范围是 0~64K。该计算机只有 32KB 的物理内存，虚拟内存技术允许该计算机运行一个 64K 大小的程序。



